{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block nav_home %}active{% endblock %}

{% block content %}
<!-- Saudação genérica sem login -->
<div class="mb-4">
    <h1 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 4px;">
        Painel de Links
    </h1>
    <p style="color: var(--gray-500); font-size: 0.9rem; margin: 0;">
        Resumo dos últimos 30 dias
    </p>
</div>

<!-- Card principal com dados gerais do sistema -->
<div class="card-app mb-4" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white;">
    <div class="card-body p-4">
        <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
                <p style="font-size: 0.8rem; opacity: 0.85; margin-bottom: 4px;">Total recebido</p>
                <h2 style="font-size: 2rem; font-weight: 700; margin: 0;">R$ {{ orders.value|default:"12.450,00"}}</h2>
            </div>
            <a href="#" class="btn btn-light btn-sm" style="border-radius: 10px; font-weight: 600;">
                <i class="bi bi-plus-lg me-1"></i>Novo Link
            </a>
        </div>
        <div class="d-flex gap-3 flex-wrap" style="font-size: 0.8rem; opacity: 0.9;">
            <span><i class="bi bi-clock me-1"></i>Pendente: R$ {{ total_pendente|default:"2.340,00" }}</span>
            <span><i class="bi bi-people me-1"></i>{{ total_vendedores|default:"5" }} vendedores</span>
        </div>
    </div>
</div>

<!-- Métricas reorganizadas com gráfico de conversão visual -->
<div class="row g-3 mb-4">
    <div class="col-8">
        <div class="card-app h-100 p-3">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <span style="font-size: 0.75rem; color: var(--gray-500); font-weight: 600; text-transform: uppercase;">Taxa de Conversão</span>
                <span style="font-size: 0.75rem; color: var(--success); font-weight: 700;">+12% este mês</span>
            </div>
            <div class="d-flex align-items-end gap-2">
                <span style="font-size: 2rem; font-weight: 700; color: var(--gray-900); line-height: 1;">67%</span>
                <span style="font-size: 0.8rem; color: var(--gray-500); margin-bottom: 4px;">32 de 48 links</span>
            </div>
            <!-- Barra de progresso visual -->
            <div class="mt-3" style="height: 8px; background: var(--gray-100); border-radius: 4px; overflow: hidden;">
                <div style="width: 67%; height: 100%; background: linear-gradient(90deg, var(--success), #34d399); border-radius: 4px;"></div>
            </div>
        </div>
    </div>
    <div class="col-4">
        <div class="card-app h-100 p-3 d-flex flex-column justify-content-between">
            <div class="text-center">
                <div style="font-size: 1.8rem; font-weight: 700; color: var(--warning);">6</div>
                <div style="font-size: 0.7rem; color: var(--gray-500);">Expiram Hoje</div>
            </div>
            <a href="#" class="btn btn-sm w-100 mt-2" style="background: rgba(249, 115, 22, 0.1); color: var(--warning); font-size: 0.7rem; font-weight: 600; border-radius: 8px;">
                Ver
            </a>
        </div>
    </div>
</div>

<!-- Mini resumo em linha -->
<div class="d-flex gap-2 mb-4" style="overflow-x: auto; padding-bottom: 4px;">
    <div class="mini-stat">
        <i class="bi bi-link-45deg"></i>
        <span><strong>48</strong> criados</span>
    </div>
    <div class="mini-stat">
        <i class="bi bi-check-circle text-success"></i>
        <span><strong>32</strong> pagos</span>
    </div>
    <div class="mini-stat">
        <i class="bi bi-clock text-warning"></i>
        <span><strong>10</strong> pendentes</span>
    </div>
    <div class="mini-stat">
        <i class="bi bi-x-circle text-danger"></i>
        <span><strong>6</strong> cancelados</span>
    </div>
</div>

<!-- Ações Rápidas -->
<p class="section-title">Ações Rápidas</p>
<div class="acoes-rapidas mb-4">
    <a href="#" class="acao-btn">
        <div class="acao-icon" style="background: rgba(99, 102, 241, 0.1); color: var(--primary);">
            <i class="bi bi-link-45deg"></i>
        </div>
        <span>Criar Link</span>
    </a>
    <a href="#" class="acao-btn">
        <div class="acao-icon" style="background: rgba(34, 197, 94, 0.1); color: var(--success);">
            <i class="bi bi-truck"></i>
        </div>
        <span>Calcular Frete</span>
    </a>
    <a href="#" class="acao-btn">
        <div class="acao-icon" style="background: rgba(249, 115, 22, 0.1); color: var(--warning);">
            <i class="bi bi-person-plus"></i>
        </div>
        <span>Vendedor</span>
    </a>
    <a href="#" class="acao-btn">
        <div class="acao-icon" style="background: rgba(107, 114, 128, 0.1); color: var(--gray-600);">
            <i class="bi bi-receipt"></i>
        </div>
        <span>Pedidos</span>
    </a>
</div>

<!-- Links recentes de todos os vendedores com filtro -->
<div class="d-flex justify-content-between align-items-center mb-2">
    <p class="section-title mb-0">Links Recentes</p>
    <a href="#" style="font-size: 0.8rem; color: var(--primary); text-decoration: none; font-weight: 600;">Ver todos</a>
</div>

<!-- Filtro rápido por vendedor -->
<div class="mb-3" style="overflow-x: auto; white-space: nowrap; padding-bottom: 8px;">
    <button class="btn btn-sm me-2 active" style="border-radius: 20px; font-size: 0.75rem; padding: 6px 14px; background: var(--primary); color: white; border: none;">
        Todos
    </button>
    <button class="btn btn-sm me-2" style="border-radius: 20px; font-size: 0.75rem; padding: 6px 14px; background: var(--gray-100); color: var(--gray-700); border: none;">
        Carlos Silva
    </button>
    <button class="btn btn-sm me-2" style="border-radius: 20px; font-size: 0.75rem; padding: 6px 14px; background: var(--gray-100); color: var(--gray-700); border: none;">
        Ana Souza
    </button>
    <button class="btn btn-sm me-2" style="border-radius: 20px; font-size: 0.75rem; padding: 6px 14px; background: var(--gray-100); color: var(--gray-700); border: none;">
        Pedro Lima
    </button>
</div>

<div class="card-app mb-4">
    <!-- Lista mostrando vendedor responsável -->
    <a href="#" class="list-item">
        <div class="list-icon bg-success-light">
            <i class="bi bi-check-circle-fill"></i>
        </div>
        <div class="list-content">
            <div class="list-title">Maria Santos</div>
            <div class="list-subtitle">
                <span class="badge-vendedor">Carlos Silva</span>
                3x de R$ 66,63
            </div>
        </div>
        <div class="list-value">
            <div class="list-amount text-success">R$ 199,90</div>
            <div class="list-date">Ontem</div>
        </div>
    </a>
    
    <a href="#" class="list-item">
        <div class="list-icon bg-warning-light">
            <i class="bi bi-clock-fill"></i>
        </div>
        <div class="list-content">
            <div class="list-title">João Oliveira</div>
            <div class="list-subtitle">
                <span class="badge-vendedor">Ana Souza</span>
                2x de R$ 74,95
            </div>
        </div>
        <div class="list-value">
            <div class="list-amount" style="color: var(--warning);">R$ 149,90</div>
            <div class="list-date">Hoje</div>
        </div>
    </a>
    
    <a href="#" class="list-item">
        <div class="list-icon bg-success-light">
            <i class="bi bi-check-circle-fill"></i>
        </div>
        <div class="list-content">
            <div class="list-title">Pedro Almeida</div>
            <div class="list-subtitle">
                <span class="badge-vendedor">Pedro Lima</span>
                À vista
            </div>
        </div>
        <div class="list-value">
            <div class="list-amount text-success">R$ 89,90</div>
            <div class="list-date">2 dias</div>
        </div>
    </a>
    
    <a href="#" class="list-item">
        <div class="list-icon bg-danger-light">
            <i class="bi bi-x-circle-fill"></i>
        </div>
        <div class="list-content">
            <div class="list-title">Fernanda Costa</div>
            <div class="list-subtitle">
                <span class="badge-vendedor">Carlos Silva</span>
                3x de R$ 99,97
            </div>
        </div>
        <div class="list-value">
            <div class="list-amount" style="color: var(--danger);">R$ 299,90</div>
            <div class="list-date">3 dias</div>
        </div>
    </a>
</div>

<!-- Seção de vendedores reformulada com visual melhor -->
<div class="d-flex justify-content-between align-items-center mb-3">
    <p class="section-title mb-0">Equipe de Vendedores</p>
    <a href="#" style="font-size: 0.8rem; color: var(--primary); text-decoration: none; font-weight: 600;">Gerenciar</a>
</div>

<div class="vendedores-grid mb-4">
    <!-- Vendedor 1 -->
    <div class="vendedor-card">
        <div class="vendedor-header">
            <div class="vendedor-avatar-lg" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">CS</div>
            <a href="#" class="vendedor-whatsapp" title="WhatsApp">
                <i class="bi bi-whatsapp"></i>
            </a>
        </div>
        <div class="vendedor-info">
            <h6>Carlos Silva</h6>
            <span class="vendedor-stats">18 links • 78%</span>
        </div>
        <div class="vendedor-valor">
            <span class="valor">R$ 4.520</span>
            <span class="label">vendidos</span>
        </div>
    </div>
    
    <!-- Vendedor 2 -->
    <div class="vendedor-card">
        <div class="vendedor-header">
            <div class="vendedor-avatar-lg" style="background: linear-gradient(135deg, #22c55e, #16a34a);">AS</div>
            <a href="#" class="vendedor-whatsapp" title="WhatsApp">
                <i class="bi bi-whatsapp"></i>
            </a>
        </div>
        <div class="vendedor-info">
            <h6>Ana Souza</h6>
            <span class="vendedor-stats">15 links • 67%</span>
        </div>
        <div class="vendedor-valor">
            <span class="valor">R$ 3.890</span>
            <span class="label">vendidos</span>
        </div>
    </div>
    
    <!-- Vendedor 3 -->
    <div class="vendedor-card">
        <div class="vendedor-header">
            <div class="vendedor-avatar-lg" style="background: linear-gradient(135deg, #f97316, #ea580c);">PL</div>
            <a href="#" class="vendedor-whatsapp" title="WhatsApp">
                <i class="bi bi-whatsapp"></i>
            </a>
        </div>
        <div class="vendedor-info">
            <h6>Pedro Lima</h6>
            <span class="vendedor-stats">15 links • 53%</span>
        </div>
        <div class="vendedor-valor">
            <span class="valor">R$ 4.040</span>
            <span class="label">vendidos</span>
        </div>
    </div>
    
    <!-- Card para adicionar vendedor -->
    <a href="#" class="vendedor-card vendedor-add">
        <div class="add-icon">
            <i class="bi bi-plus-lg"></i>
        </div>
        <span>Adicionar</span>
    </a>
</div>

<!-- Gráfico visual simples dos últimos 7 dias -->
<p class="section-title">Últimos 7 dias</p>
<div class="card-app p-3 mb-4">
    <div class="grafico-barras">
        <div class="grafico-dia">
            <div class="barra-container">
                <div class="barra" style="height: 40%;"></div>
            </div>
            <span class="dia-label">Seg</span>
        </div>
        <div class="grafico-dia">
            <div class="barra-container">
                <div class="barra" style="height: 65%;"></div>
            </div>
            <span class="dia-label">Ter</span>
        </div>
        <div class="grafico-dia">
            <div class="barra-container">
                <div class="barra" style="height: 50%;"></div>
            </div>
            <span class="dia-label">Qua</span>
        </div>
        <div class="grafico-dia">
            <div class="barra-container">
                <div class="barra" style="height: 80%;"></div>
            </div>
            <span class="dia-label">Qui</span>
        </div>
        <div class="grafico-dia">
            <div class="barra-container">
                <div class="barra" style="height: 95%;"></div>
            </div>
            <span class="dia-label">Sex</span>
        </div>
        <div class="grafico-dia">
            <div class="barra-container">
                <div class="barra" style="height: 70%;"></div>
            </div>
            <span class="dia-label">Sáb</span>
        </div>
        <div class="grafico-dia hoje">
            <div class="barra-container">
                <div class="barra barra-hoje" style="height: 55%;"></div>
            </div>
            <span class="dia-label">Hoje</span>
        </div>
    </div>
    <div class="d-flex justify-content-between mt-3 pt-3" style="border-top: 1px solid var(--gray-100);">
        <div>
            <span style="font-size: 0.75rem; color: var(--gray-500);">Esta semana</span>
            <div style="font-size: 1.1rem; font-weight: 700; color: var(--gray-900);">R$ 3.240,00</div>
        </div>
        <div class="text-end">
            <span style="font-size: 0.75rem; color: var(--gray-500);">Semana passada</span>
            <div style="font-size: 1.1rem; font-weight: 600; color: var(--gray-500);">R$ 2.890,00</div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* Ações Rápidas Grid */
    .acoes-rapidas {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
    }
    
    .acao-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        padding: 16px 8px;
        background: white;
        border-radius: 16px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        transition: all 0.2s;
    }
    
    .acao-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    
    .acao-icon {
        width: 48px;
        height: 48px;
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 8px;
    }
    
    .acao-icon i {
        font-size: 1.4rem;
    }
    
    .acao-btn span {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--gray-700);
        text-align: center;
    }
    
    /* Mini stats em linha */
    .mini-stat {
        display: flex;
        align-items: center;
        gap: 6px;
        background: white;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        color: var(--gray-600);
        white-space: nowrap;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    
    .mini-stat strong {
        color: var(--gray-900);
    }
    
    /* Badge do vendedor */
    .badge-vendedor {
        display: inline-block;
        background: var(--gray-100);
        color: var(--gray-600);
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 4px;
        margin-right: 6px;
        font-weight: 600;
    }
    
    /* Grid de vendedores */
    .vendedores-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }
    
    .vendedor-card {
        background: white;
        border-radius: 16px;
        padding: 16px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        text-decoration: none;
    }
    
    .vendedor-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 12px;
    }
    
    .vendedor-avatar-lg {
        width: 48px;
        height: 48px;
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
        font-size: 1rem;
    }
    
    .vendedor-whatsapp {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: rgba(37, 211, 102, 0.1);
        color: #25D366;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        text-decoration: none;
        transition: all 0.2s;
    }
    
    .vendedor-whatsapp:hover {
        background: #25D366;
        color: white;
    }
    
    .vendedor-info h6 {
        font-size: 0.9rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0 0 2px 0;
    }
    
    .vendedor-stats {
        font-size: 0.7rem;
        color: var(--gray-500);
    }
    
    .vendedor-valor {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px solid var(--gray-100);
        display: flex;
        align-items: baseline;
        gap: 4px;
    }
    
    .vendedor-valor .valor {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--success);
    }
    
    .vendedor-valor .label {
        font-size: 0.7rem;
        color: var(--gray-500);
    }
    
    /* Card adicionar vendedor */
    .vendedor-add {
        border: 2px dashed var(--gray-200);
        background: transparent;
        box-shadow: none;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 140px;
        transition: all 0.2s;
    }
    
    .vendedor-add:hover {
        border-color: var(--primary);
        background: rgba(99, 102, 241, 0.02);
    }
    
    .vendedor-add .add-icon {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: var(--gray-100);
        color: var(--gray-400);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        margin-bottom: 8px;
        transition: all 0.2s;
    }
    
    .vendedor-add:hover .add-icon {
        background: var(--primary);
        color: white;
    }
    
    .vendedor-add span {
        font-size: 0.8rem;
        font-weight: 600;
        color: var(--gray-400);
    }
    
    .vendedor-add:hover span {
        color: var(--primary);
    }
    
    /* Gráfico de barras simples */
    .grafico-barras {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        height: 100px;
        gap: 8px;
    }
    
    .grafico-dia {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
    }
    
    .barra-container {
        width: 100%;
        height: 80px;
        display: flex;
        align-items: flex-end;
    }
    
    .barra {
        width: 100%;
        background: linear-gradient(180deg, var(--primary), #818cf8);
        border-radius: 6px 6px 2px 2px;
        min-height: 8px;
        transition: all 0.3s;
    }
    
    .barra-hoje {
        background: linear-gradient(180deg, var(--success), #34d399);
    }
    
    .dia-label {
        font-size: 0.65rem;
        color: var(--gray-500);
        font-weight: 500;
    }
    
    .grafico-dia.hoje .dia-label {
        color: var(--success);
        font-weight: 700;
    }
    
    /* Responsivo */
    @media (max-width: 380px) {
        .acoes-rapidas {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .vendedores-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}
